<!doctype html>  
<html lang="en" >
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<title>Digital Mindmapping</title>
	<link href="css/dm.css" rel="stylesheet" />		
	<h1 font id="webfontH9pO81ke" >Digital Mindmapping</h1>
	<h2>0xC001D00D?</h2>	
	
	<script src="js/painter.js"></script>
    <script type="text/javascript">


		var mindmap = null;
		var sm = null;
		
		function document_load()
		{
			
		  updateDatalist();	
		  sm = new StateMachine(states);
		  mindmap = new MindMap(document.getElementById("canvas"));
		  mindmap.performState();
		}
		
		function getdoi()
		{
			var xmlhttp;
		
		 if (window.XMLHttpRequest)
		  {
		    xmlhttp=new XMLHttpRequest();
		  }
		 else
		  {
		    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		  }
		
		 xmlhttp.onreadystatechange=function()
		 {
		  if (xmlhttp.readyState==4 && xmlhttp.status==200 )				  
		  {
		      var myArray = eval( xmlhttp.responseText );
		      document.getElementById("author").value=myArray[0];
		      document.getElementById("title").value=myArray[1];
		      document.getElementById("date").value=myArray[2];
		      document.getElementById("publisher").value=myArray[3];
		  }
		 }
		  
		 var doifield = document.getElementById("doifield").value;   
		 xmlhttp.open("GET","php/doihandler.php?doi="+doifield,true);
		 xmlhttp.send();
       }
		
		
		
		function submitnewpaper()
		{
			var xmlhttp;

			
			var doi=document.getElementById("doifield").value;
			var author=document.getElementById("author").value;
			var title=document.getElementById("title").value;
			var publisher=document.getElementById("publisher").value;
			var date=document.getElementById("date").value;
			
			if (window.XMLHttpRequest)
			  {
			    xmlhttp=new XMLHttpRequest();
			  }
			 else
			  {
			    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			  }
			
			xmlhttp.onreadystatechange=function()
			 {
			  if (xmlhttp.readyState==4 && xmlhttp.status==200 )				  
			  {  
			     //alert (xmlhttp.responseText);
			  }
			 }
			 xmlhttp.open("GET","php/newpaper.php?doi="+doi+"&author="+author+"&title="+title+"&publisher="+publisher+"&date="+date,true);
			 xmlhttp.send(); 
			 
				document.getElementById("publisher").value="";
				document.getElementById("title").value="";
				document.getElementById("author").value="";
				document.getElementById("date").value="";
				updateDatalist()
			 
		}
		
		function updateDatalist()
		{
			
			if (window.XMLHttpRequest)
			  {
			    xmlhttp=new XMLHttpRequest();
			  }
			 else
			  {
			    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			  }
			
			xmlhttp.onreadystatechange=function()
			 {
			  if (xmlhttp.readyState==4 && xmlhttp.status==200 )				  
			  { 
				var jsonPapers = eval( '(' + xmlhttp.responseText + ')' );
				var tag;
				
                // console.log(jsonPapers.length);
                // console.log(jsonPapers[1].author);
				
				for (var i=0; i<jsonPapers.length;i++) 
				{ 
					tag = '<option label="'+ jsonPapers[i].title +'" value="' + jsonPapers[i].author + ' ' + jsonPapers[i].date + '  ----- ' + jsonPapers[i].title  + '" />';
					document.getElementById('bibliothek').innerHTML += tag;
					document.getElementById('bibliothek2').innerHTML += tag;
				}
				
			  }
			 }
			 xmlhttp.open("GET","php/gettotalpapers.php",true);
			 xmlhttp.send(); 
		}
		
		
			
	</script>
</head>


  <body id="thebody" onload="document_load()">
  <canvas id="canvas" width="1000" height= "400" tabindex="0"></canvas>
  
  <input class="form" id="paper" list="bibliothek" type="text" name="bibliothek" placeholder="please select from your library here ..." />
  <datalist id="bibliothek">
  

  </datalist>
  <p>
  
  <details class="form">
    <summary>Add to library</summary>

   <form >
		<fieldset>
    
      <label for="doifield">DOI</label>
      <input class="refform" id="doifield" name="doifield" type="text" placeholder="Enter your doi ..." />
      <input class="buttons" type="button" value="Get Paper" onclick="getdoi();" />
	
			
		<ul>	
		    <br>
        	<label for="author">Author</label>
        	<input class="refform" id="author" name="author" type="text" placeholder="Set the author names ..." />	
			</br>
			<br>
        	<label for="title">Title</label>
        	<input class="refform" id="title" name="title "type="text" placeholder="Set the title ..." />   		
			</br>
			<br>
        	<label for="date">Date</label>
        	<input class="refform" id="date" name="date" type="text" placeholder="Set the date ..." /> 		
			</br>
			<br>
        	<label for="publisher">Publisher</label>
        	<input class="refform" id="publisher" name="publisher" type="text" placeholder="Set the publisher ..." />
			</br>		    
		</ul>
		<input class="buttons" type="button" value="Submit" onclick="submitnewpaper()" />
       </fieldset>
     </form>
    
    
  </details>
    <details class="form">
    <summary>Delete from library</summary>
    <input class="form" id="paper" list="bibliothek" type="text" name="bibliothek" placeholder="please select which entry to delete from your library ..." />  
    <datalist id="bibliothek2"> 
    </datalist>  
  </details>
  
  <details class="form">
    <summary>Bibliography</summary>
    <textarea rows="10" class="form">
      Here will be the bibliography.
    </textarea>     
  </details>  
  
  <footer>
  	The content of these web pages is not generated by and does not represent the views of Santa Clara University or any of its departments or organizations.
  </footer>

</body>
</html>
