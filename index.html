<!doctype html>  
<html lang="en" >
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<title>Digital Mindmapping</title>
	<link href="css/dm.css" rel="stylesheet" />		
	<h1 font id="webfontH9pO81ke" >Digital Mindmapping</h1>
	<h2>0xC001D00D?</h2>	
	
	<script src="js/painter.js"></script>
    <script type="text/javascript">


		var mindmap = null;
		var sm = null;
		
		function document_load()
		{
		  sm = new StateMachine(states);
		  mindmap = new MindMap(document.getElementById("canvas"));
		  mindmap.performState();
		}
		
		
		
		function getdoi()
		{
			
			document.getElementById("publisher").value="";
			document.getElementById("title").value="";
		
		if (window.XMLHttpRequest)
		  {// code for IE7+, Firefox, Chrome, Opera, Safari
		    xmlhttp=new XMLHttpRequest();
		    
		  }
		else
		  {// code for IE6, IE5
		    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		  }
		
		  xmlhttp.onreadystatechange=function()
		  {
		  if (xmlhttp.readyState==4 && xmlhttp.status==200)
		    {
			  
			  
		      //document.getElementById("publisher").value=xmlhttp.responseText;
		      var myArray = eval( xmlhttp.responseText );
		      document.getElementById("author").value=myArray[0];
		      document.getElementById("title").value=myArray[1];
		      document.getElementById("date").value=myArray[2];
		      document.getElementById("publisher").value=myArray[3];
		    }
		  }
		  
		var doifield = document.getElementById("doifield").value;   
		xmlhttp.open("GET","php/doihandler.php?doi="+doifield,true);
		xmlhttp.send();
		}
			
	</script>
</head>

  <?php

        include 'php/ez_sql_core.php';
        include 'php/ez_sql_mysql.php';
        include 'php/config.php';
		

        $conn = new ezSQL_mysql($dbuser, $dbpass, $dbname, $dbhost);

        if (!$conn)
         {
                die('Could not connect: ' . mysql_error());
         }
        $query  = "select * from lit_testuser";
        $result = $conn->get_results($query);
        if (!$result) die ("Query Failed.");
        
      ?>


  <body onload="document_load()">
  <canvas id="canvas" width="1000" height= "400" tabindex="0"></canvas>
  
  <input class="form" id="paper" list="bibliothek" type="text" name="bibliothek" placeholder="please select from your library here ..." />
  <datalist id="bibliothek">
    <!option label="The Fundamentals of Political Science Research." value="Kellstedt" />
    <!option label="A Lack of Leadership Threatens Energy Policy." value="Kolarska-Bobinska 2012" />
    <!option label="From Policy Entrepreneur to Policy Manager: The Challenge Facing the European Commission." value="Laffan 1997" />
    <!option label="The Leadership Capacity of the European Commission." value="Nugen 1995" />

	<?php foreach($result as $i){ ?>
		<option value="<?php echo $i->title; ?>"><?php echo $i->title; ?></option>
	<?php } ?>

  </datalist>
  <p>
  
  <details class="form">
    <summary>Add to library</summary>
    <form>
		<fieldset>		
		<ul>
		    
		    <label for="doifield">DOI</label>
        	<input class="refform" id="doifield" type="text" placeholder="Enter your doi ..." />
        	<input class="buttons" type="submit" value="Get Paper" onclick="getdoi();" />
		
        	<label for="author">Author</label>
        	<input class="refform" id="author" type="text" placeholder="Set the author names ..." />	
        	<label for="title">Title</label>
        	<input class="refform" id="title" type="text" placeholder="Set the title ..." />   		
        	<label for="date">Date</label>
        	<input class="refform" id="date" type="text" placeholder="Set the date ..." /> 		
        	<label for="publisher">Publisher</label>
        	<input class="refform" id="publisher" type="text" placeholder="Set the publisher ..." />
		</ul>
		<input class="buttons" type="submit" value="Submit" />
       </fieldset>
     </form>
    
    
  </details>
    <details class="form">
    <summary>Delete from library</summary>
    <input class="form" id="paper" list="bibliothek" type="text" name="bibliothek" placeholder="please select which entry to delete from your library ..." />  
    
  </details>
  
  <details class="form">
    <summary>Bibliography</summary>
    <textarea rows="10" class="form">
      Here will be the bibliography.
    </textarea>     
  </details>  
  
  <input type="button" class="button" value="Add reference" onclick="graph.createElement(literatureTemplate);" /> 

  <?php
	$conn->disconnect();
  ?>
  
  <footer>
  	The content of these web pages is not generated by and does not represent the views of Santa Clara University or any of its departments or organizations.
  </footer>

</body>
</html>
